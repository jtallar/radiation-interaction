import utils

# 1. Turn off plotting in config --> plot: false
# 2. Run multiple simulations with different dts and all algos
# ./target/tp4-simu-1.0/damped-osc.sh -Dalgo=Beeman -Ddt=0.0001 --> BEEMAN-0.0001.txt
# python analysisOsc.py BEEMAN-0.0001.txt BEEMAN-0.001.txt BEEMAN-0.01.txt
# 3. Replace delta_t values and ecms below with obtained values
# 4. Run python aux_analysisOscDelta.py

# Replace delta_t values here (delta_t_sim = delta_t_print) [0.0001:0.0005:0.0601]
dts = [0.0001, 0.0006, 0.0011, 0.0016, 0.0021, 0.0026, 0.0031, 0.0036, 0.0041, 0.0046, 0.0051, 0.0056, 0.0061, 0.0066, 0.0071, 0.0076, 0.0081, 0.0086, 0.0091, 0.0096, 0.0101, 0.0106, 0.0111, 0.0116, 0.0121, 0.0126, 0.0131, 0.0136, 0.0141, 0.0146, 0.0151, 0.0156, 0.0161, 0.0166, 0.0171, 0.0176, 0.0181, 0.0186, 0.0191, 0.0196, 0.0201, 0.0206, 0.0211, 0.0216, 0.0221, 0.0226, 0.0231, 0.0236, 0.0241, 0.0246, 0.0251, 0.0256, 0.0261, 0.0266, 0.0271, 0.0276, 0.0281, 0.0286, 0.0291, 0.0296, 0.0301, 0.0306, 0.0311, 0.0316, 0.0321, 0.0326, 0.0331, 0.0336, 0.0341, 0.0346, 0.0351, 0.0356, 0.0361, 0.0366, 0.0371, 0.0376, 0.0381, 0.0386, 0.0391, 0.0396, 0.0401, 0.0406, 0.0411, 0.0416, 0.0421, 0.0426, 0.0431, 0.0436, 0.0441, 0.0446, 0.0451, 0.0456, 0.0461, 0.0466, 0.0471, 0.0476, 0.0481, 0.0486, 0.0491, 0.0496, 0.0501, 0.0506, 0.0511, 0.0516, 0.0521, 0.0526, 0.0531, 0.0536, 0.0541, 0.0546, 0.0551, 0.0556, 0.0561, 0.0566, 0.0571, 0.0576, 0.0581, 0.0586, 0.0591, 0.0596, 0.0601]
# Replace ecm values for beeman here
ecms_beeman = [3.4817385E-14, 4.4928779E-11, 5.0541040E-10, 2.2523172E-09, 6.6548019E-09, 1.5570084E-08, 3.1326510E-08, 5.6725133E-08, 9.4988480E-08, 1.4990806E-07, 2.2561377E-07, 3.2636179E-07, 4.5736739E-07, 6.2395603E-07, 8.3269336E-07, 1.0879297E-06, 1.3984581E-06, 1.7696873E-06, 2.2091623E-06, 2.7212165E-06, 3.3208048E-06, 4.0084101E-06, 4.8066257E-06, 5.7029005E-06, 6.7252550E-06, 7.8658772E-06, 9.1473857E-06, 1.0578757E-05, 1.2167960E-05, 1.3960794E-05, 1.5889788E-05, 1.7990778E-05, 2.0325067E-05, 2.2917838E-05, 2.5713229E-05, 2.8703431E-05, 3.1987942E-05, 3.5467839E-05, 3.9266018E-05, 4.3410164E-05, 4.7748648E-05, 5.2451454E-05, 5.7547479E-05, 6.3071646E-05, 6.8765854E-05, 7.4894391E-05, 8.1489346E-05, 8.8187327E-05, 9.5776328E-05, 1.0345427E-04, 1.1165148E-04, 1.2040108E-04, 1.2910998E-04, 1.3900453E-04, 1.4882391E-04, 1.6001076E-04, 1.7106006E-04, 1.8274910E-04, 1.9510977E-04, 2.0817857E-04, 2.2199786E-04, 2.3661684E-04, 2.5063222E-04, 2.6684395E-04, 2.8233412E-04, 3.0032269E-04, 3.1741237E-04, 3.3532054E-04, 3.5407447E-04, 3.7370310E-04, 3.9669380E-04, 4.1833445E-04, 4.3817501E-04, 4.6166173E-04, 4.8622696E-04, 5.1192947E-04, 5.3883664E-04, 5.6319628E-04, 5.9231931E-04, 6.2284420E-04, 6.5022153E-04, 6.8327538E-04, 7.1282764E-04, 7.4864823E-04, 7.8048263E-04, 8.1936429E-04, 8.5360916E-04, 8.8911803E-04, 9.3273644E-04, 9.7087441E-04, 1.0103601E-03, 1.0512130E-03, 1.1019165E-03, 1.1457734E-03, 1.1911167E-03, 1.2379796E-03, 1.2863969E-03, 1.3364066E-03, 1.3880499E-03, 1.4413715E-03, 1.4964199E-03, 1.5532468E-03, 1.6119081E-03, 1.6724633E-03, 1.7349765E-03, 1.7995173E-03, 1.8661615E-03, 1.9349928E-03, 2.0061036E-03, 2.0608996E-03, 2.1355714E-03, 2.2126739E-03, 2.2923251E-03, 2.3746620E-03, 2.4368259E-03, 2.5232059E-03, 2.6124433E-03, 2.7047374E-03, 2.7731168E-03, 2.8699120E-03, 2.9699770E-03]
# Replace ecm values for verlet here
ecms_verlet = [1.2010344E-07, 4.3463907E-06, 1.4685821E-05, 3.1230376E-05, 5.4080651E-05, 8.3340805E-05, 1.1909120E-04, 1.6145369E-04, 2.1046246E-04, 2.6643216E-04, 3.2939457E-04, 3.9905451E-04, 4.7592748E-04, 5.6006041E-04, 6.5220221E-04, 7.5098845E-04, 8.5821254E-04, 9.7291450E-04, 1.0954307E-03, 1.2244112E-03, 1.3632729E-03, 1.5087570E-03, 1.6662452E-03, 1.8281400E-03, 2.0010488E-03, 2.1798015E-03, 2.3684263E-03, 2.5666091E-03, 2.7738426E-03, 2.9978284E-03, 3.2215863E-03, 3.4515142E-03, 3.6973740E-03, 3.9606998E-03, 4.2294089E-03, 4.5012205E-03, 4.7901686E-03, 5.0796904E-03, 5.3861560E-03, 5.7108524E-03, 6.0324314E-03, 6.3714867E-03, 6.7292240E-03, 7.1072285E-03, 7.4757273E-03, 7.8627929E-03, 8.2696358E-03, 8.6593822E-03, 9.1068211E-03, 9.5343883E-03, 9.9813483E-03, 1.0448762E-02, 1.0886058E-02, 1.1394105E-02, 1.1868490E-02, 1.2421860E-02, 1.2936643E-02, 1.3471707E-02, 1.4027900E-02, 1.4606239E-02, 1.5207933E-02, 1.5834417E-02, 1.6395707E-02, 1.7069395E-02, 1.7671225E-02, 1.8397080E-02, 1.9042395E-02, 1.9708963E-02, 2.0397262E-02, 2.1107941E-02, 2.1975165E-02, 2.2739534E-02, 2.3382787E-02, 2.4191978E-02, 2.5028457E-02, 2.5893462E-02, 2.6788382E-02, 2.7530468E-02, 2.8479336E-02, 2.9461826E-02, 3.0268878E-02, 3.1312094E-02, 3.2163789E-02, 3.3272654E-02, 3.4172117E-02, 3.5351776E-02, 3.6302563E-02, 3.7274701E-02, 3.8564548E-02, 3.9594015E-02, 4.0647148E-02, 4.1724150E-02, 4.3176097E-02, 4.4319530E-02, 4.5490257E-02, 4.6688984E-02, 4.7916568E-02, 4.9173976E-02, 5.0462257E-02, 5.1782511E-02, 5.3135874E-02, 5.4523504E-02, 5.5946576E-02, 5.7406277E-02, 5.8903803E-02, 6.0440361E-02, 6.2017166E-02, 6.3635446E-02, 6.5296445E-02, 6.6316017E-02, 6.8045809E-02, 6.9822240E-02, 7.1646571E-02, 7.3520052E-02, 7.4620180E-02, 7.6574110E-02, 7.8581953E-02, 8.0644830E-02, 8.1817441E-02, 8.3969718E-02, 8.6182805E-02]
# Replace ecm values for gpc5 here
ecms_gear_5 = [3.9369475E-18, 3.8402236E-18, 3.9407300E-18, 4.0139670E-18, 4.3684331E-18, 8.5845621E-18, 3.0639663E-17, 1.2053927E-16, 4.4961966E-16, 1.4373377E-15, 4.1009303E-15, 1.0603463E-14, 2.5397026E-14, 5.6734464E-14, 1.1990513E-13, 2.4056577E-13, 4.6299426E-13, 8.5668498E-13, 1.5327230E-12, 2.6565195E-12, 4.4859821E-12, 7.3848551E-12, 1.1910790E-11, 1.8780585E-11, 2.9096649E-11, 4.4251269E-11, 6.6275152E-11, 9.7837658E-11, 1.4246377E-10, 2.0533561E-10, 2.9150890E-10, 4.0890887E-10, 5.6874284E-10, 7.8486808E-10, 1.0717745E-09, 1.4484385E-09, 1.9445901E-09, 2.5851609E-09, 3.4162028E-09, 4.4891412E-09, 5.8452393E-09, 7.5720522E-09, 9.7615987E-09, 1.2527572E-08, 1.5938733E-08, 2.0193035E-08, 2.5480672E-08, 3.1881452E-08, 3.9929361E-08, 4.9595398E-08, 6.1390430E-08, 7.5742870E-08, 9.2679793E-08, 1.1364056E-07, 1.3820828E-07, 1.6851539E-07, 2.0380398E-07, 2.4583000E-07, 2.9576979E-07, 3.5499052E-07, 4.2507834E-07, 5.0786860E-07, 6.0174464E-07, 7.1586444E-07, 8.4453011E-07, 1.0007243E-06, 1.1758840E-06, 1.3790253E-06, 1.6142514E-06, 1.8862150E-06, 2.2155538E-06, 2.5802638E-06, 2.9787715E-06, 3.4578253E-06, 4.0079386E-06, 4.6388893E-06, 5.3616435E-06, 6.1415036E-06, 7.0791290E-06, 8.1495689E-06, 9.2966237E-06, 1.0676314E-05, 1.2147795E-05, 1.3918756E-05, 1.5799531E-05, 1.8063585E-05, 2.0459713E-05, 2.3146505E-05, 2.6385156E-05, 2.9792375E-05, 3.3604113E-05, 3.7865965E-05, 4.3011664E-05, 4.8386773E-05, 5.4384477E-05, 6.1073119E-05, 6.8528215E-05, 7.6833141E-05, 8.6079983E-05, 9.6370414E-05, 1.0781671E-04, 1.2054293E-04, 1.3468576E-04, 1.5039693E-04, 1.6784053E-04, 1.8720822E-04, 2.0867869E-04, 2.3256682E-04, 2.5895492E-04, 2.8603914E-04, 3.2146165E-04, 3.6907633E-04, 4.6691157E-04, 7.2276321E-04, 1.9136052E-03, 6.0957764E-03, 2.1096536E-02, 7.4352637E-02, 3.3574732E-01, 1.1290935E+00, 3.6697690E+00]

# Initialize plotting
utils.init_plotter()

utils.plot_multiple_values([dts, dts, dts], 'dt (s)', [ecms_beeman, ecms_verlet, ecms_gear_5], 'ecm (m^2)', ['beeman', 'verlet', 'gear'], log=True, legend_loc='lower right')

# Hold execution
utils.hold_execution()